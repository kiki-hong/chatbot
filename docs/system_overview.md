# 한의학 AI 컨설턴트 시스템 동작 원리

이 문서는 한의학 AI 컨설턴트가 어떻게 작동하는지, 특히 **RAG (검색 증강 생성)** 기술을 활용하여 어떻게 전문적인 한의학 정보를 제공하는지 설명합니다.

## 1. 전체 흐름도

```mermaid
graph TD
    User[👤 사용자] -->|1. 질문: '체했을 때 좋은 혈자리는?'| UI[💻 웹사이트 (채팅창)]
    UI -->|2. API 요청| Server[🖥️ 서버 (Next.js)]
    
    subgraph "RAG (검색 증강 생성) 프로세스"
        Server -->|3. 관련 내용 검색| KB[📂 지식 베이스\n(한의학 서적/논문)]
        KB -->|4. 데이터 추출: '합곡혈, 소화불량...'| Server
        
        Server -->|5. 프롬프트 조합| Prompt[📝 완성된 명령문\n(질문 + 의학 지식 + 페르소나)]
        
        Prompt -->|6. 전송| AI[🧠 Google Gemini AI]
    end
    
    AI -->|7. 답변 생성| Stream[🌊 실시간 답변 스트림]
    Stream -->|8. 한 글자씩 전송| UI
    UI -->|9. 화면 표시| User

    style User fill:#f9f,stroke:#333,stroke-width:2px
    style UI fill:#bbf,stroke:#333,stroke-width:2px
    style Server fill:#dfd,stroke:#333,stroke-width:2px
    style AI fill:#fdd,stroke:#333,stroke-width:4px
    style KB fill:#ffd,stroke:#333,stroke-width:2px
    style Prompt fill:#fff,stroke:#333,stroke-dasharray: 5 5
```

## 2. 핵심 기술: RAG (Retrieval-Augmented Generation)

이 챗봇은 한의학 전문 서적을 펼쳐놓고 상담하는 **한의사**와 같습니다.

*   **일반 AI**: 인터넷의 방대한 정보를 바탕으로 답하지만, 출처가 불분명하거나 부정확할 수 있습니다.
*   **한의학 AI (RAG)**: 질문을 받으면 검증된 **한의학 지식 베이스**에서 관련 내용을 먼저 찾아보고, 그 내용에 근거하여 답변합니다.

### 작동 예시

1.  **사용자 질문**: "잠이 안 올 때 마시면 좋은 차 있어?"
2.  **시스템의 속마음 (내부 처리)**:
    *   *"키워드 '불면증', '차', '약초'로 지식 베이스를 검색하자."*
    *   *(검색 중...)* -> *"찾았다! '산조인(묏대추 씨)은 심신을 안정시키고 불면증에 효과가 있다'는 내용이 있네."*
    *   *"이제 AI에게 지시하자: '사용자가 불면증 차를 찾고 있어. 산조인에 대한 정보를 바탕으로 따뜻하고 친절하게 추천해줘.'"*
    *   *"주의사항 추가: '단, 전문적인 치료가 필요할 수 있음을 언급할 것.'"*
3.  **AI의 답변**: "불면증으로 고생하고 계시군요. 마음을 편안하게 해주는 '산조인차'를 추천드립니다. 산조인은 묏대추의 씨앗으로..."

## 3. 주요 구성 요소

| 요소 | 역할 | 비유 |
| :--- | :--- | :--- |
| **웹사이트 (Frontend)** | 사용자와 대화하는 진료실 | 접수처 / 상담실 |
| **서버 (Backend)** | 질문을 분석하고 자료를 찾는 시스템 | 예진실 / 차트 관리자 |
| **지식 베이스 (Data)** | `data/` 폴더 내의 한의학 문서들 | 동의보감 / 본초강목 / 현대 한의학 서적 |
| **Google Gemini (AI)** | 정보를 종합하여 설명하는 두뇌 | AI 한의사 |

## 4. 왜 이 방식이 좋은가요?

1.  **신뢰성**: 검증되지 않은 민간요법이 아닌, 문헌에 근거한 정보를 제공합니다.
2.  **안전성**: 답변 생성 시 안전 관련 지침(병원 방문 권유 등)을 프롬프트에 포함하여 위험한 자가 진단을 방지합니다.
3.  **전문성**: 일반적인 건강 상식 수준을 넘어, 구체적인 본초학적 효능이나 경혈 위치 등을 안내할 수 있습니다.
